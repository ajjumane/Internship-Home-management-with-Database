<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <title>Home Hub Pro</title>
    <style>
        :root { --sidebar-width: 250px; }
        body { background: #f8f9fa; }
        .sidebar { width: var(--sidebar-width); height: 100vh; position: fixed; background: #212529; color: white; padding: 20px; }
        .main-content { margin-left: var(--sidebar-width); padding: 30px; }
        .stat-card { border: none; border-radius: 15px; transition: transform 0.2s; }
        .stat-card:hover { transform: translateY(-5px); }
        .done-text { text-decoration: line-through; color: #adb5bd; }
    </style>
</head>
<body>
    <div class="sidebar">
        <h4>üè† Home Hub</h4><hr>
        <p class="text-secondary">Hello, {{ current_user.username }}</p>
        <nav class="nav flex-column mt-4">
            <a class="nav-link text-white active" href="#"><i class="fas fa-home me-2"></i> Dashboard</a>
            <a class="nav-link text-white" href="/logout"><i class="fas fa-sign-out-alt me-2"></i> Logout</a>
        </nav>
    </div>

    <div class="main-content">
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card stat-card bg-primary text-white p-3">
                    <h6>Pending Chores</h6>
                    <h2>{{ pending }}</h2>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card stat-card bg-success text-white p-3">
                    <h6>Total Expenses</h6>
                    <h2>${{ "%.2f"|format(total) }}</h2>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-7">
                <div class="card p-4 shadow-sm mb-4">
                    <h5 class="mb-3">Tasks Management</h5>
                    <form action="/add_chore" method="POST" class="input-group mb-4">
                        <input type="text" name="task" class="form-control" placeholder="What needs to be done?" required>
                        <input type="text" name="person" class="form-control" placeholder="Assigned To">
                        <button class="btn btn-dark" type="submit"><i class="fas fa-plus"></i></button>
                    </form>
                    <div class="list-group">
                        {% for chore in chores %}
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <a href="/toggle_chore/{{ chore.id }}" class="btn btn-sm {{ 'btn-success' if chore.is_done else 'btn-outline-secondary' }} me-2">
                                    <i class="fas fa-check"></i>
                                </a>
                                <span class="{{ 'done-text' if chore.is_done }}">{{ chore.task }}</span>
                                <small class="text-muted ms-2">({{ chore.assigned_to }})</small>
                            </div>
                            <a href="/delete_chore/{{ chore.id }}" class="text-danger"><i class="fas fa-trash"></i></a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="col-lg-5">
                <div class="card p-4 shadow-sm">
                    <h5 class="mb-3">Money Tracker</h5>
                    <form action="/add_expense" method="POST" class="mb-4">
                        <input type="text" name="item" class="form-control mb-2" placeholder="Item Name" required>
                        <div class="input-group">
                            <input type="number" step="0.01" name="amount" class="form-control" placeholder="Price" required>
                            <button class="btn btn-success" type="submit">Add</button>
                        </div>
                    </form>
                    <table class="table table-hover">
                        {% for exp in expenses %}
                        <tr>
                            <td>{{ exp.item }}</td>
                            <td class="text-end text-success font-monospace">${{ "%.2f"|format(exp.amount) }}</td>
                            <td class="text-end"><a href="/delete_expense/{{ exp.id }}" class="text-danger small"><i class="fas fa-times"></i></a></td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html>